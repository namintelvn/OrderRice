var registerDialog,socket=io(window.location.href),itemPrice=32e3,countRegister=0;socket.on("server-register-failed",function(){$("#register_label").html("Someone take your name then change it.")}),socket.on("server-register-success",function(e){countRegister=-1,registerDialog.dialog("close"),localStorage.setItem("name",e)}),socket.on("server-getlistfood",function(e){$("#content").html(e),$("img").each(function(e,t){$(t).attr("src","https://www.anzi.com.vn"+$(t).attr("src"))}),$(".des").remove(),$(".update").remove(),$(".name").each(function(e,t){var r=$(this).text().trim();$(this).after(`<button name="${r}" class="btn-order btn btn-primary">Order</button>`),socket.emit("client-order",{name:r,flag:0})}),$(".btn-order").each(function(e,t){$(t).click(function(e){localStorage.getItem("name")&&("Order"==$(this).text().trim()?($(this).text("Cancel").removeClass("btn-primary").addClass("btn-danger"),socket.emit("client-order",{name:$(this).attr("name"),flag:1})):($(this).text("Order").addClass("btn-primary").removeClass("btn-danger"),socket.emit("client-order",{name:$(this).attr("name"),flag:-1})))})}),$("#order").css("display","")}),socket.on("server-getlistorder",function(e){var t=e.orderItems,r=0,o=[];$("#order tbody").html("");var n=localStorage.getItem("name");for(const e in t)if(t.hasOwnProperty(e)){const a=t[e].quantity,i=t[e].orderUser;r+=a,$("#order tbody").append(`\n        <tr>\n          <td>${e}</td>\n          <td>${a}</td>\n          <td>${itemPrice.toLocaleString()} đ</td>\n          <td>${Object.keys(i).filter(e=>1==i[e])}</td>\n        </tr>\n      `),i[n]&&o.push(e)}for(const e of o)$(`.btn-order[name="${e}"]`).text("Cancel").removeClass("btn-primary").addClass("btn-danger");$("#orderCount").text(r),$("#orderMoney").text((r*itemPrice).toLocaleString()+" đ"),""!==e.log&&$("textarea").text($("textarea").text()+"\n"+e.log)}),socket.on("error",function(e){console.log(e)}),$(document).ready(function(){var e;function t(){$("#register_name").val()&&socket.emit("client-register",{targetName:escape($("#register_name").val()),flag:1})}e=new Date,$("#timeNow").html("THỰC ĐƠN ("+e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()+")"),registerDialog=$("#dialog-register").dialog({autoOpen:!1,buttons:{Register:t},close:function(){switch(countRegister){case-1:return;case 0:$("#register_label").html("Tell me who are you ?"),countRegister++;break;case 1:$("#register_label").html("Don't make ask twice! Who the fuck are you?"),countRegister++;break;case 2:$("#register_label").html("You wanna die? Last chance, who are you?"),countRegister++;break;default:window.close()}registerDialog.dialog("open")}}),function(){const e=localStorage.getItem("name");e?socket.emit("client-register",{targetName:e,flag:0}):registerDialog.dialog("open")}(),socket.emit("client-getlistfood"),socket.emit("client-getlistorder","")});